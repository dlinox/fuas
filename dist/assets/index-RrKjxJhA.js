import{i as B,d as P,e as c,r as a,o as C,c as $,w as o,a as e,u as w,g as v,f as G,j as N,k as j,b as K,t as O}from"./index-DfaDZCSX.js";import{i as L,_ as q}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-B4ijjvvj.js";import{r as E}from"./ruleUtils-DaB-ACZt.js";import{d as F}from"./debounce-DqPPCsFD.js";const A="https://api.fuas.linox.net.pe/api/categories",Q=async _=>{try{const i=localStorage.getItem("token");return(await B(i,A).post("/load-data-table",_)).data.data}catch{return L()}},W=async _=>{try{const i=localStorage.getItem("token");return await B(i,A).post("/save",_),!0}catch{return!1}},M=async _=>{try{const i=localStorage.getItem("token");return await B(i,A).delete(`/delete/${_}`),!0}catch{return!1}},z={name:[E],type:[E]},X=()=>({id:null,name:"",type:null,status:!0}),H=P({__name:"Form",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(_,{emit:i}){const r=i,m=_,f=c(!1),l=c(!1),t=c(null),s=c({...X(),...m.formState}),p=async()=>{const{valid:b}=await t.value.validate();if(!b)return;f.value=!0,await W(s.value)&&(s.value.id==null&&t.value.reset(),r("onSuccess"),l.value=!1),f.value=!1};return(b,n)=>{const g=a("v-text-field"),y=a("v-col"),d=a("v-select"),x=a("v-switch"),u=a("v-row"),k=a("v-card-item"),V=a("v-btn"),T=a("v-spacer"),R=a("v-card-actions"),I=a("v-card"),D=a("v-form"),S=a("v-dialog");return C(),$(S,{"max-width":"700",modelValue:l.value,"onUpdate:modelValue":n[4]||(n[4]=U=>l.value=U),activator:"parent"},{default:o(()=>[e(D,{ref_key:"formRef",ref:t,onSubmit:G(p,["prevent"])},{default:o(()=>[e(I,{title:s.value.id?"Editar Registro":"Nuevo Registro"},{default:o(()=>[e(k,{class:"border-t border-b"},{default:o(()=>[e(u,null,{default:o(()=>[e(y,{cols:"12"},{default:o(()=>[e(g,{modelValue:s.value.name,"onUpdate:modelValue":n[0]||(n[0]=U=>s.value.name=U),label:"Nombre",rules:w(z).name},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:o(()=>[e(d,{modelValue:s.value.type,"onUpdate:modelValue":n[1]||(n[1]=U=>s.value.type=U),items:["ASISTENCIAL","ADMINISTRATIVO"],label:"Tipo",rules:w(z).type},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:o(()=>[e(x,{label:s.value.status?"Habilitado":"Deshabilitado",modelValue:s.value.status,"onUpdate:modelValue":n[2]||(n[2]=U=>s.value.status=U),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(R,null,{default:o(()=>[e(V,{type:"button",variant:"text",color:"secondary",onClick:n[3]||(n[3]=U=>l.value=!1)},{default:o(()=>n[5]||(n[5]=[v(" Cancelar ")])),_:1}),e(T),e(V,{text:"Guardar",color:"primary",type:"submit",loading:f.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},512)]),_:1},8,["modelValue"])}}}),Y=[{title:"Op.",key:"actions",value:"actions",fixed:!0,width:"50px",sortable:!1},{title:"Nombre",key:"name",value:"name"},{title:"Tipo",key:"type",value:"type"},{title:"Estado",key:"status",value:"status"}],Z=[{title:"Op.",key:"actions",value:"actions",fixed:!0,width:"50px",sortable:!1},{title:"Nombre",key:"name",value:"name"},{title:"Estado",key:"status",value:"status"}],J="https://api.fuas.linox.net.pe/api/services",h=async _=>{try{const i=localStorage.getItem("token");return(await B(i,J).post("/load-data-table",_)).data.data}catch{return L()}},ee=async _=>{try{const i=localStorage.getItem("token");return await B(i,J).post("/save",_),!0}catch{return!1}},te=P({__name:"service",setup(_){const i=c(!1),r=c(!1),m=c(!1),f=c([]),l=c(0),t=c({itemsPerPage:10,sortBy:[],page:1,search:"",filters:{}}),s=F(()=>{p()},400),p=async()=>{m.value=!0;const n=await h(t.value);f.value=n.data,l.value=n.total,m.value=!1},b=async()=>{r.value=!0,await p(),r.value=!1};return b(),(n,g)=>{const y=a("v-text-field"),d=a("v-col"),x=a("v-btn"),u=a("v-row"),k=a("v-card-item"),V=a("v-card"),T=a("v-dialog"),R=N("tooltip");return C(),$(T,{"max-width":"900",modelValue:i.value,"onUpdate:modelValue":g[1]||(g[1]=I=>i.value=I),activator:"parent"},{default:o(()=>[e(V,{title:"Servicios",subtitle:"Gestion de servicios",disabled:r.value},{default:o(()=>[e(k,{class:"border-t border-b"},{default:o(()=>[e(u,{class:"d-flex justify-space-between"},{default:o(()=>[e(d,{cols:"12",md:"4"},{default:o(()=>[e(y,{modelValue:t.value.search,"onUpdate:modelValue":g[0]||(g[0]=I=>t.value.search=I),label:"Buscar",clearable:"",onInput:w(s)},null,8,["modelValue","onInput"])]),_:1}),e(d,{cols:"12",md:"4",class:"d-md-flex d-block justify-end text-end"},{default:o(()=>[e(x,{class:"h-md-auto me-2",disabled:r.value},{default:o(()=>[g[2]||(g[2]=v(" nuevo ")),e(w(ie),{onOnSuccess:p})]),_:1},8,["disabled"]),j(e(x,{class:"h-md-auto",density:"comfortable",icon:"mdi-reload",onClick:b,loading:m.value},null,8,["loading"]),[[R,"Recargar registros"]])]),_:1})]),_:1})]),_:1}),e(w(le),{options:t.value,loading:m.value,items:f.value,total:l.value,onOnUpdateTable:p},null,8,["options","loading","items","total"])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])}}}),oe={class:"d-flex align-center"},ae=P({__name:"DataTable",props:{options:{},items:{},loading:{type:Boolean},total:{}},emits:["onUpdateTable"],setup(_,{emit:i}){const r=i,m=c(!1),f=async l=>{m.value=!0,await M(l)&&r("onUpdateTable"),m.value=!1};return(l,t)=>{const s=a("v-icon"),p=a("v-btn"),b=a("v-list-item"),n=a("v-list"),g=a("v-menu"),y=a("v-chip"),d=a("v-data-table-server"),x=N("tooltip");return C(),$(d,{"items-per-page":l.options.itemsPerPage,"onUpdate:itemsPerPage":[t[1]||(t[1]=u=>l.options.itemsPerPage=u),t[4]||(t[4]=u=>r("onUpdateTable"))],"sort-by":l.options.sortBy,"onUpdate:sortBy":[t[2]||(t[2]=u=>l.options.sortBy=u),t[5]||(t[5]=u=>r("onUpdateTable"))],page:l.options.page,"onUpdate:page":[t[3]||(t[3]=u=>l.options.page=u),t[6]||(t[6]=u=>r("onUpdateTable"))],headers:w(Y),items:l.items,"items-length":l.total,loading:m.value,"item-value":"id","multi-sort":""},{"item.actions":o(({item:u})=>[K("div",oe,[j((C(),$(p,{icon:"",density:"compact",color:"black",variant:"text"},{default:o(()=>[e(s,null,{default:o(()=>t[7]||(t[7]=[v("mdi-format-list-bulleted-type")])),_:1}),e(te)]),_:2},1024)),[[x,"Servicios de "+u.name]]),e(p,{icon:"",density:"compact",variant:"text"},{default:o(()=>[e(s,null,{default:o(()=>t[8]||(t[8]=[v("mdi-dots-vertical")])),_:1}),e(g,{activator:"parent"},{default:o(()=>[e(n,{density:"compact"},{default:o(()=>[e(b,{key:"edit",value:"edit","append-icon":"mdi-pencil",class:"text-subtitle-2"},{append:o(()=>[e(s,{size:"small"},{default:o(()=>t[9]||(t[9]=[v(" mdi-pencil ")])),_:1})]),default:o(()=>[t[10]||(t[10]=v(" Editar ")),e(w(H),{formState:u,onOnSuccess:t[0]||(t[0]=k=>r("onUpdateTable"))},null,8,["formState"])]),_:2},1024),e(b,{key:"delete",value:"delete",class:"text-red text-subtitle-2"},{append:o(()=>[e(s,{size:"small",color:"red"},{default:o(()=>t[11]||(t[11]=[v(" mdi-delete ")])),_:1})]),default:o(()=>[t[12]||(t[12]=v(" Eliminar ")),e(q,{title:"Eliminar",message:"¿Está seguro de eliminar este registro?","text-cancel":"No","text-confirm":"Confirmar",loading:m.value,onOnConfirm:()=>f(u.id)},null,8,["loading","onOnConfirm"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"item.type":o(({item:u})=>[e(y,{color:u.type==="ASISTENCIAL"?"teal-darken-3":"blue-grey-darken-1","text-color":"white"},{default:o(()=>[v(O(u.type),1)]),_:2},1032,["color"])]),"item.status":o(({item:u})=>[e(p,{color:u.status?"blue":"error","text-color":"white",density:"compact",variant:"tonal"},{default:o(()=>[v(O(u.status?"Habilitado":"Deshabilitado"),1)]),_:2},1032,["color"])]),_:1},8,["items-per-page","sort-by","page","headers","items","items-length","loading"])}}}),le=P({__name:"ServiceDataTable",props:{options:{},items:{},loading:{type:Boolean},total:{}},emits:["onUpdateTable"],setup(_,{emit:i}){const r=i,m=c(!1),f=async l=>{m.value=!0,await M(l)&&r("onUpdateTable"),m.value=!1};return(l,t)=>{const s=a("v-icon"),p=a("v-list-item"),b=a("v-list"),n=a("v-menu"),g=a("v-btn"),y=a("v-data-table-server");return C(),$(y,{"items-per-page":l.options.itemsPerPage,"onUpdate:itemsPerPage":[t[1]||(t[1]=d=>l.options.itemsPerPage=d),t[4]||(t[4]=d=>r("onUpdateTable"))],"sort-by":l.options.sortBy,"onUpdate:sortBy":[t[2]||(t[2]=d=>l.options.sortBy=d),t[5]||(t[5]=d=>r("onUpdateTable"))],page:l.options.page,"onUpdate:page":[t[3]||(t[3]=d=>l.options.page=d),t[6]||(t[6]=d=>r("onUpdateTable"))],headers:w(Z),items:l.items,"items-length":l.total,loading:m.value,"item-value":"id","multi-sort":""},{"item.actions":o(({item:d})=>[e(g,{icon:"",density:"compact",variant:"text"},{default:o(()=>[e(s,null,{default:o(()=>t[7]||(t[7]=[v("mdi-dots-vertical")])),_:1}),e(n,{activator:"parent"},{default:o(()=>[e(b,{density:"compact"},{default:o(()=>[e(p,{key:"edit",value:"edit","append-icon":"mdi-pencil",class:"text-subtitle-2"},{append:o(()=>[e(s,{size:"small"},{default:o(()=>t[8]||(t[8]=[v(" mdi-pencil ")])),_:1})]),default:o(()=>[t[9]||(t[9]=v(" Editar ")),e(w(H),{formState:d,onOnSuccess:t[0]||(t[0]=x=>r("onUpdateTable"))},null,8,["formState"])]),_:2},1024),e(p,{key:"delete",value:"delete",class:"text-red text-subtitle-2"},{append:o(()=>[e(s,{size:"small",color:"red"},{default:o(()=>t[10]||(t[10]=[v(" mdi-delete ")])),_:1})]),default:o(()=>[t[11]||(t[11]=v(" Eliminar ")),e(q,{title:"Eliminar",message:"¿Está seguro de eliminar este registro?","text-cancel":"No","text-confirm":"Confirmar",loading:m.value,onOnConfirm:()=>f(d.id)},null,8,["loading","onOnConfirm"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"item.status":o(({item:d})=>[e(g,{color:d.status?"blue":"error","text-color":"white",density:"compact",variant:"tonal"},{default:o(()=>[v(O(d.status?"Habilitado":"Deshabilitado"),1)]),_:2},1032,["color"])]),_:1},8,["items-per-page","sort-by","page","headers","items","items-length","loading"])}}}),ne={name:[E]},se=()=>({id:null,name:"",status:!0}),ie=P({__name:"ServiceForm",props:{formState:{type:Object,default:()=>({})}},emits:["onSuccess"],setup(_,{emit:i}){const r=i,m=_,f=c(!1),l=c(!1),t=c(null),s=c({...se(),...m.formState}),p=async()=>{const{valid:b}=await t.value.validate();if(!b)return;f.value=!0,await ee(s.value)&&(s.value.id==null&&t.value.reset(),r("onSuccess"),l.value=!1),f.value=!1};return(b,n)=>{const g=a("v-text-field"),y=a("v-col"),d=a("v-switch"),x=a("v-row"),u=a("v-card-item"),k=a("v-btn"),V=a("v-spacer"),T=a("v-card-actions"),R=a("v-card"),I=a("v-form"),D=a("v-dialog");return C(),$(D,{"max-width":"700",modelValue:l.value,"onUpdate:modelValue":n[3]||(n[3]=S=>l.value=S),activator:"parent"},{default:o(()=>[e(I,{ref_key:"formRef",ref:t,onSubmit:G(p,["prevent"])},{default:o(()=>[e(R,{title:s.value.id?"Editar Registro":"Nuevo Registro"},{default:o(()=>[e(u,{class:"border-t border-b"},{default:o(()=>[e(x,null,{default:o(()=>[e(y,{cols:"12"},{default:o(()=>[e(g,{modelValue:s.value.name,"onUpdate:modelValue":n[0]||(n[0]=S=>s.value.name=S),label:"Nombre",rules:w(ne).name},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:o(()=>[e(d,{label:s.value.status?"Habilitado":"Deshabilitado",modelValue:s.value.status,"onUpdate:modelValue":n[1]||(n[1]=S=>s.value.status=S),color:"blue-darken-4",inset:""},null,8,["label","modelValue"])]),_:1})]),_:1})]),_:1}),e(T,null,{default:o(()=>[e(k,{type:"button",variant:"text",color:"secondary",onClick:n[2]||(n[2]=S=>l.value=!1)},{default:o(()=>n[4]||(n[4]=[v(" Cancelar ")])),_:1}),e(V),e(k,{text:"Guardar",color:"primary",type:"submit",loading:f.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},512)]),_:1},8,["modelValue"])}}}),ce=P({__name:"index",setup(_){const i=c(!1),r=c(!1),m=c([]),f=c(0),l=c({itemsPerPage:10,sortBy:[],page:1,search:"",filters:{}}),t=F(()=>{s()},400),s=async()=>{r.value=!0;const b=await Q(l.value);m.value=b.data,f.value=b.total,r.value=!1},p=async()=>{i.value=!0,await s(),i.value=!1};return p(),(b,n)=>{const g=a("v-text-field"),y=a("v-col"),d=a("v-btn"),x=a("v-row"),u=a("v-card-item"),k=a("v-card"),V=N("tooltip");return C(),$(k,{title:"Categorías",subtitle:"Gestion de categorías",disabled:i.value},{default:o(()=>[e(u,{class:"border-t border-b"},{default:o(()=>[e(x,{class:"d-flex justify-space-between"},{default:o(()=>[e(y,{cols:"12",md:"4"},{default:o(()=>[e(g,{modelValue:l.value.search,"onUpdate:modelValue":n[0]||(n[0]=T=>l.value.search=T),label:"Buscar",clearable:"",onInput:w(t)},null,8,["modelValue","onInput"])]),_:1}),e(y,{cols:"12",md:"4",class:"d-md-flex d-block justify-end text-end"},{default:o(()=>[e(d,{class:"h-md-auto me-2",disabled:i.value},{default:o(()=>[n[1]||(n[1]=v(" nuevo ")),e(w(H),{onOnSuccess:s})]),_:1},8,["disabled"]),j(e(d,{class:"h-md-auto",density:"comfortable",icon:"mdi-reload",onClick:p,loading:r.value},null,8,["loading"]),[[V,"Recargar registros"]])]),_:1})]),_:1})]),_:1}),e(w(ae),{options:l.value,loading:r.value,items:m.value,total:f.value,onOnUpdateTable:s},null,8,["options","loading","items","total"])]),_:1},8,["disabled"])}}});export{ce as default};
